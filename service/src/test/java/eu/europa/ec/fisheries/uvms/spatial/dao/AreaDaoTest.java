package eu.europa.ec.fisheries.uvms.spatial.dao;

import com.vividsolutions.jts.geom.Coordinate;
import com.vividsolutions.jts.geom.Geometry;
import eu.europa.ec.fisheries.uvms.spatial.entity.AreaLocationTypesEntity;
import eu.europa.ec.fisheries.uvms.spatial.entity.CountriesEntity;
import eu.europa.ec.fisheries.uvms.spatial.util.SqlPropertyHolder;
import junitparams.JUnitParamsRunner;
import junitparams.Parameters;
import lombok.SneakyThrows;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;

import javax.persistence.EntityTransaction;
import java.util.List;

import static eu.europa.ec.fisheries.uvms.spatial.util.SpatialTypeEnum.getNativeQueryByType;
import static junitparams.JUnitParamsRunner.$;
import static org.junit.Assert.assertEquals;

@RunWith(JUnitParamsRunner.class)
public class AreaDaoTest extends BaseSpatialDaoTest {

    private AreaDao areaDao = new AreaDao(em, new SqlPropertyHolder());

    private CountriesEntity austria;

    @Before
    @SneakyThrows
    public void prepare(){

        Geometry geometry = wktReader.read("MULTIPOLYGON(((15.1617924400001 48.9372207640001,15.238066854 48.9507599890001,15.2432344970001 48.9529304,15.2570837810001 48.963885803,15.2603910730001 48.9691568000001,15.2628715420001 48.9825926720001,15.2669023030001 48.9866751110001,15.2745504150001 48.9867267870001,15.2796147060001 48.9825926720001,15.2837488200001 48.977631735,15.2887097570001 48.975357972,15.335528605 48.9749962370001,15.3578528230001 48.9708104460001,15.4059119060001 48.9546873990001,15.4503536380001 48.9448172,15.4718510330001 48.9367040000001,15.5212537030001 48.9084886680001,15.5441866810001 48.9026117330001,15.6037292880001 48.8873530070001,15.6813472900001 48.8584658820001,15.7037748610001 48.8549518840001,15.72682255 48.8549518840001,15.743669067 48.8584658820001,15.7792224530001 48.870868225,15.787904093 48.872263489,15.8184965410001 48.872315165,15.8242843010001 48.869421285,15.828315064 48.8571222950001,15.8332760010001 48.8520063280001,15.8400972900001 48.8500943000001,15.8592175700001 48.8491641240001,15.8701729730001 48.843893128,15.8776143790001 48.841671041,15.8859859610001 48.8420327760001,15.8757540280001 48.8330927530001,15.8883630770001 48.8350564580001,15.8996285400001 48.8347464000001,15.9070699460001 48.8302505490001,15.9081034750001 48.8197085580001,15.9250533450001 48.822602438,15.9303243410001 48.8183132940001,15.9303243410001 48.8113886520001,15.9317712810001 48.8064277140001,16.0323336180001 48.7580585740001,16.0853536380001 48.7428657020001,16.1777510980001 48.7465347290001,16.3175875240001 48.732840475,16.3187244060001 48.7335122680001,16.3394983310001 48.7355793260001,16.352727498 48.728447978,16.3583085530001 48.72725942,16.3740181880001 48.7303083290001,16.3849735920001 48.7370779430001,16.435719848 48.7945421350001,16.4530831300001 48.8021902470001,16.4819185790001 48.7993997190001,16.4922538650001 48.7997097790001,16.510340617 48.8047740690001,16.5195390220001 48.805600891,16.5287374260001 48.8035338340001,16.5457906500001 48.7962991340001,16.6055286050001 48.7848269650001,16.6240287670001 48.7833800260001,16.6431490470001 48.7782640590001,16.6510038660001 48.76622345,16.6547245690001 48.751857402,16.6619592690001 48.7400234990001,16.6750850830001 48.733925679,16.6910014240001 48.732065328,16.729035279 48.7330988570001,16.7443315020001 48.7296365360001,16.7805050050001 48.7137718710001,16.7989018140001 48.709224345,16.8181254470001 48.7107746380001,16.8565727130001 48.7198180140001,16.8730058190001 48.7189911910001,16.8966736250001 48.6969770300001,16.9105229080001 48.6307795210001,16.9450427660001 48.6041661580001,16.9543445230001 48.5573989870001,16.9490548790001 48.544836083,16.9469031170001 48.5397256470001,16.9304700120001 48.528201803,16.9139335530001 48.5193392950001,16.9064921470001 48.5099083460001,16.9012211500001 48.496601665,16.875072876 48.4715385950001,16.8649442950001 48.4580768850001,16.8608101810001 48.4437883510001,16.8519218340001 48.3904065960001,16.8493380120001 48.3841020710001,16.8468575440001 48.3811306760001,16.8451005450001 48.376583151,16.8444804280001 48.365601909,16.8475810140001 48.3595816040001,16.8553324790001 48.3564551800001,16.8754862870001 48.3550340780001,16.8811706950001 48.3528119920001,16.8917126870001 48.347024231,16.901944621 48.3394019580001,16.9064921470001 48.3314696250001,16.904218384 48.3270254520001,16.9002909750001 48.3212376910001,16.8984306230001 48.3161734010001,16.9027714440001 48.3141063440001,16.9054586180001 48.3119876100001,16.908869263 48.3069749960001,16.9120732010001 48.3012389120001,16.9133134350001 48.2966913860001,16.9166207270001 48.290800273,16.9242688390001 48.2875188200001,16.9333638920001 48.2847282920001,16.9444226480001 48.2780103560001,16.9506238200001 48.2765892540001,16.9543445230001 48.2731269330001,16.9552746990001 48.2687861130001,16.953931112 48.257339784,16.9543445230001 48.252559713,16.9699508050001 48.2166445930001,16.9747050370001 48.1985578420001,16.9748083900001 48.1768795780001,16.9819397380001 48.161299134,17.0071578370001 48.142798971,17.0209037680001 48.1371662400001,17.0369234620001 48.135512594,17.0474654540001 48.1309909060001,17.0624552960001 48.1127244880001,17.067205851 48.1069355270001,17.0802283120001 48.0976079310001,17.0699963780001 48.089158834,17.0648287350001 48.0790302540001,17.059144327 48.0604267370001,17.0630717370001 48.0587730920001,17.0750606690001 48.0520809940001,17.0696863200001 48.0356737260001,17.092630656 48.027250468,17.124980103 48.0195248410001,17.1483378500001 48.005443014,17.0856026610001 47.9701480110001,17.0961446530001 47.9619314580001,17.0957312420001 47.9557302860001,17.0908736570001 47.9494774380001,17.0880831300001 47.9408991500001,17.0861194260001 47.939219666,17.076817668 47.9349563600001,17.074130493 47.9321141570001,17.0751640220001 47.9277733360001,17.080124959 47.9257579550001,17.0853959550001 47.924621074,17.087463013 47.922631531,17.0833288980001 47.9048290000001,17.0775411380001 47.8917290250001,17.0676192620001 47.8816262820001,17.0511861570001 47.8728929650001,17.0165629480001 47.8676994830001,17.0040572510001 47.8632811480001,17.0043673100001 47.8523774210001,17.0106718340001 47.8478815720001,17.0316524660001 47.8413445040001,17.0395072830001 47.837365418,17.0491191 47.8186843880001,17.0556303300001 47.812354025,17.0406441650001 47.8011144000001,17.0419877520001 47.7839061490001,17.0487056890001 47.7636489870001,17.0505660400001 47.730989482,17.0555269770001 47.7209125780001,17.0640019120001 47.713290304,17.0753707280001 47.7084843960001,17.0548035080001 47.7020248420001,16.9819397380001 47.6954360960001,16.9026680910001 47.682026062,16.8647375890001 47.6867286170001,16.8501648360001 47.712928569,16.8369356690001 47.7053579710001,16.8172986250001 47.684248149,16.8062398680001 47.676884257,16.797454874 47.675463156,16.7411275640001 47.6814576220001,16.7303788660001 47.6859017950001,16.7192167560001 47.6937307740001,16.7115686440001 47.704066061,16.7078479410001 47.7146080530001,16.702473592 47.723599752,16.6898645430001 47.72956838,16.6097660730001 47.7506265260001,16.56780481 47.7541922,16.5311145420001 47.7429784150001,16.5251200760001 47.7333149210001,16.5268770750001 47.7201374310001,16.5213993730001 47.711533305,16.5129244380001 47.706003927,16.4730302320001 47.6917670700001,16.4611446530001 47.6845323700001,16.4545300700001 47.6817676800001,16.4498791910001 47.682413635,16.4449182540001 47.6855400600001,16.4391304930001 47.6904751590001,16.4317924400001 47.6854625450001,16.4165995680001 47.668822734,16.4078145750001 47.6613296510001,16.4259013260001 47.6542758180001,16.4819185790001 47.638953756,16.5096171470001 47.6431395470001,16.5754529210001 47.624949443,16.6084224860001 47.6287734990001,16.6302299400001 47.6220038860001,16.6476965740001 47.606139221,16.656171509 47.5859337370001,16.6505904540001 47.5665550740001,16.6675403240001 47.5600955210001,16.6813896080001 47.5505612190001,16.689141072 47.538029684,16.6880041910001 47.5226301070001,16.6773588460001 47.5098660280001,16.6482133390001 47.5015461220001,16.6368445230001 47.493200378,16.6408752840001 47.4529186000001,16.626973417 47.445548935,16.5894055580001 47.4256334440001,16.4819185790001 47.3923021450001,16.469929647 47.4055313120001,16.456597128 47.4118358360001,16.4440914300001 47.4095103970001,16.4339628500001 47.396849671,16.4364433190001 47.358505758,16.4342729080001 47.3555602010001,16.4293119710001 47.3538032020001,16.4249711500001 47.351116028,16.4243510340001 47.3451990770001,16.427141561 47.3413750200001,16.4316890870001 47.3397213750001,16.4361332600001 47.3385586550001,16.4388204350001 47.3365691130001,16.469206177 47.2932384240001,16.473236938 47.2768053190001,16.4666223550001 47.2634211230001,16.4524630120001 47.2545844530001,16.4213538 47.2431381230001,16.4213538 47.2430606080001,16.4213538 47.2430347700001,16.4246610920001 47.2255939740001,16.4092615150001 47.203683166,16.4127755120001 47.1871725460001,16.418769979 47.1836585500001,16.426728149 47.1841236370001,16.4350997320001 47.1835810340001,16.4418176670001 47.17712148,16.4421277270001 47.1683364870001,16.4339628500001 47.1512832650001,16.4336527920001 47.1457538860001,16.4470886640001 47.1397077430001,16.4808850510001 47.1507665010001,16.4973181560001 47.1496812950001,16.5095137930001 47.1375373340001,16.5047595630001 47.1258326210001,16.4819185790001 47.1052395630001,16.4608345950001 47.0962995400001,16.4543233640001 47.081700949,16.461764771 47.0684976200001,16.4819185790001 47.0638984170001,16.4937008050001 47.0598159790001,16.4972148030001 47.0546224980001,16.4931840410001 47.0491447960001,16.4819185790001 47.044209697,16.437166788 47.0317815150001,16.4246610920001 47.024081726,16.4532898360001 47.0216787730001,16.4675525310001 47.0184231570001,16.4819185790001 47.0093797810001,16.4863627520001 46.9985535690001,16.4674491780001 46.9954271450001,16.4414042560001 46.995220439,16.4247644450001 46.993101705,16.4247644450001 46.9929983520001,16.4204236250001 46.9902595010001,16.4155660400001 46.9894326790001,16.4103983960001 46.9904145310001,16.4050240480001 46.9931533820001,16.38776412 47.0020417280001,16.3665767820001 47.0038245650001,16.3258557530001 47.0004397580001,16.2885453690001 47.0055815640001,16.2749027910001 47.0043154910001,16.2653943280001 46.9932567350001,16.2610535070001 46.9780897020001,16.2529919840001 46.9735163380001,16.2430701090001 46.972017721,16.2329415280001 46.9660749310001,16.2303577070001 46.959977112,16.2311845300001 46.954421895,16.2306677650001 46.9483499150001,16.2239498290001 46.941063538,16.217025187 46.937394511,16.1961479090001 46.931296692,16.170723104 46.9185326130001,16.1591475830001 46.9103160610001,16.1228707280001 46.8763646450001,16.1100549720001 46.867915548,16.0940352780001 46.862773743,16.0529355460001 46.8460598520001,16.0320235600001 46.8375556440001,16.0284409450001 46.836947433,15.9875818280001 46.830010885,15.9816907150001 46.827685446,15.971975545 46.8206316120001,15.9729057210001 46.8184353640001,15.977349894 46.8162132770001,15.9781767170001 46.8091336070001,15.9712520750001 46.7780760700001,15.9709846650001 46.7750498790001,15.9697017820001 46.760531922,15.9705286060001 46.7430136110001,15.9820007730001 46.71854482,16.0032914630001 46.7091913860001,16.0145569250001 46.6937142950001,16.0167225790001 46.6706913420001,16.0167273360001 46.670640768,16.0165930590001 46.6707569690001,15.9979171140001 46.686918844,15.9869617100001 46.6921898400001,15.9463440340001 46.697150777,15.8785445550001 46.720715231,15.8507426350001 46.7244876110001,15.8229407140001 46.7228339640001,15.7846099100001 46.7121995030001,15.7551412350001 46.7040237430001,15.7286829020001 46.7029902150001,15.6520984290001 46.7108191930001,15.6359753820001 46.7175629680001,15.6328747960001 46.7024734500001,15.63297815 46.6896318570001,15.626983684 46.6808727010001,15.6217452710001 46.6781749180001,15.6166483970001 46.6755500280001,15.6037292880001 46.6730178840001,15.5886397710001 46.6759634400001,15.56734908 46.675756735,15.5459550370001 46.6718810020001,15.530658814 46.6638453170001,15.5208402920001 46.6496084600001,15.5203081380001 46.6477201710001,15.5176363530001 46.638239645,15.5139394500001 46.632545221,15.5112284750001 46.6283694460001,15.4926249590001 46.6182925420001,15.4626526280001 46.6146493530001,15.440018352 46.6243903610001,15.4353808740001 46.6271952870001,15.4175907800001 46.637955424,15.388135214 46.6455776980001,15.3327837340001 46.6435796750001,15.204890585 46.6389631150001,15.1725567510001 46.6413595130001,15.1055914420001 46.6463225960001,15.085722504 46.6477951670001,15.0619535720001 46.6495567830001,15.0043860270001 46.6368443810001,14.967178995 46.6002574670001,14.9479553620001 46.6192743940001,14.9335893150001 46.6211347460001,14.9195067690001 46.6150167520001,14.8977258710001 46.6055543020001,14.8940627220001 46.6052154610001,14.8770552980001 46.603642274,14.862999308 46.604830831,14.8503902590001 46.601135967,14.8336470950001 46.5843928020001,14.8222782790001 46.567546285,14.8145193090001 46.551337476,14.8071887620001 46.536023662,14.7966625040001 46.5194009470001,14.7885852450001 46.5066456100001,14.7830041910001 46.5032608040001,14.7608866780001 46.496284485,14.735255167 46.493338928,14.7263668210001 46.497705587,14.7097270100001 46.492512106,14.7037325440001 46.487757874,14.6987716070001 46.4809624230001,14.687092733 46.471221416,14.6799613850001 46.4588707480001,14.6725458400001 46.4597905060001,14.6666288650001 46.460524394,14.6620813390001 46.4596975710001,14.6420308840001 46.4452281700001,14.6316955970001 46.4405772910001,14.6215670170001 46.4385102340001,14.5998629150001 46.4371666460001,14.5901477460001 46.4344277950001,14.5753682860001 46.4197258510001,14.5669967040001 46.4003730270001,14.5621081980001 46.391736666,14.5576949460001 46.383939921,14.5403316650001 46.3786430870001,14.5271024980001 46.3882290650001,14.5158370360001 46.405359803,14.5021944580001 46.4183564260001,14.4676746010001 46.4126720180001,14.4509314370001 46.4144806930001,14.4371447520001 46.418884133,14.4200289310001 46.4243508920001,14.4144478760001 46.4290017700001,14.4112439370001 46.4346345020001,14.4064897050001 46.4393370570001,14.3958443610001 46.4409907020001,14.362151327 46.4358747360001,14.2423232220001 46.438237462,14.1498645430001 46.4400605270001,14.147933084 46.4404246540001,14.1372554930001 46.4424376430001,14.0810315350001 46.475949809,14.0663554280001 46.481039938,14.0500256760001 46.484398905,14.0324556880001 46.484708965,14.0149216090001 46.4825306520001,13.9987626540001 46.4805231740001,13.9823295490001 46.481918437,13.8908622640001 46.5117874150001,13.8606832280001 46.5152497360001,13.7957776290001 46.507885845,13.7821350510001 46.5077824920001,13.7160925700001 46.5188670870001,13.7009513750001 46.519745586,13.6853450930001 46.517626851,13.6702555740001 46.518712057,13.5492293700001 46.545842184,13.5067513430001 46.5469273890001,13.4991032300001 46.5506222540001,13.4849438890001 46.5617326860001,13.4780192460001 46.5635672000001,13.4170410560001 46.5604924520001,13.3733227940001 46.565789286,13.2714168700001 46.5507772830001,13.2311092530001 46.5521725470001,13.2100252690001 46.5580119830001,13.1464632570001 46.584961243,13.0645044350001 46.5980353800001,12.8304101970001 46.60963674,12.7735661220001 46.6351907350001,12.7484995040001 46.6409960410001,12.7398730880001 46.642993876,12.7320182700001 46.6422704070001,12.7159985760001 46.637955424,12.7065934650001 46.6377487190001,12.6973950610001 46.6405392460001,12.6792049560001 46.650021871,12.6713676500001 46.6524657630001,12.6695931390001 46.6530191050001,12.6201904710001 46.6564814250001,12.5620028070001 46.6512104290001,12.5473267010001 46.6521922810001,12.5307902420001 46.6576699840001,12.4998877360001 46.672139385,12.4696321900001 46.675798865,12.4456274820001 46.6787022920001,12.4050098060001 46.690122783,12.3703865960001 46.71115509,12.351473023 46.7432461550001,12.342688029 46.7651311240001,12.326048218 46.7724950160001,12.3052742920001 46.77445872,12.2843970130001 46.779988099,12.2747851970001 46.7846389770001,12.269100789 46.7885663870001,12.2667236730001 46.7953359990001,12.2669303800001 46.808255107,12.2696175540001 46.8198306280001,12.2733382570001 46.82675527,12.2761287840001 46.8339899700001,12.2758187260001 46.8462889610001,12.2666203200001 46.8681480920001,12.2508073320001 46.8756153370001,12.2087427160001 46.8766230270001,12.195100138 46.8800853480001,12.1890023190001 46.8849429320001,12.1835246170001 46.891221619,12.1721558020001 46.8991797890001,12.1609936930001 46.9030296840001,12.1374292400001 46.9059235640001,12.1268872470001 46.90886912,12.1415633550001 46.9188426720001,12.141666708 46.9279894000001,12.1347420650001 46.9374461880001,12.1282308350001 46.9485824590001,12.1221330150001 46.9716559860001,12.117792196 46.9830764770001,12.1111776120001 46.9929983520001,12.1217196040001 47.0105166630001,12.1822843830001 47.033616028,12.2035750730001 47.0533305880001,12.203896989 47.067011988,12.2041951910001 47.0796855670001,12.1806307370001 47.0852149450001,12.1331463140001 47.0788316060001,12.1162419030001 47.0765591430001,12.0149560960001 47.040488994,11.9436426180001 47.0381635550001,11.8995109460001 47.0277249150001,11.8570329190001 47.0120152790001,11.8225130610001 46.9932567350001,11.7771411540001 46.988295797,11.7660823970001 46.9834382130001,11.746445353 46.972456971,11.7348698320001 46.970622457,11.7161629640001 46.975480042,11.6838135170001 46.991913147,11.6647965900001 46.9932567350001,11.6572518310001 46.9925332640001,11.6497070720001 46.9929983520001,11.648466838 46.9932567350001,11.6479500730001 46.9932567350001,11.5964803470001 47.0004397580001,11.5727091880001 46.998915304,11.543667033 46.993101705,11.5435636800001 46.993101705,11.5433569740001 46.9929983520001,11.5432536210001 46.9929983520001,11.5338485110001 46.9895360320001,11.5244434 46.9883474730001,11.5153483480001 46.9894843550001,11.5069767660001 46.9929983520001,11.5017057700001 46.997855937,11.4959180090001 47.0016024780001,11.4894067790001 47.0042121380001,11.4718367920001 47.007080181,11.4618115640001 47.0055040490001,11.4529232170001 47.000879009,11.4452751060001 46.993101705,11.4451717530001 46.9929983520001,11.4111686610001 46.9704932660001,11.3805762120001 46.9715526330001,11.3494670010001 46.9819395960001,11.3138102620001 46.9872622680001,11.2437370200001 46.9792524220001,11.1744906010001 46.9638528450001,11.1566105550001 46.9565147910001,11.0919116620001 46.9124347950001,11.0836434320001 46.9001358040001,11.0731014410001 46.864969992,11.0542912190001 46.834144999,11.0534643960001 46.8303209430001,11.0546012770001 46.8199339800001,11.0528442790001 46.8149213670001,11.0485034580001 46.8116915900001,11.0374447020001 46.808255107,11.0333105880001 46.8055679320001,11.0108830160001 46.7792129520001,10.9969303790001 46.7691102100001,10.9826676840001 46.7677407840001,10.9657178140001 46.7716423540001,10.9308878990001 46.7739936330001,10.9137313230001 46.772339986,10.880348348 46.7645885220001,10.8704264730001 46.7640717570001,10.8601945390001 46.7669914760001,10.8431413170001 46.777042542,10.8341496170001 46.7802464800001,10.8239176840001 46.780349833,10.804900757 46.7766291300001,10.7950822350001 46.7768875130001,10.7663501380001 46.788101299,10.7547746180001 46.7907626340001,10.7336906330001 46.7861892710001,10.7229419350001 46.7864476520001,10.716947469 46.7952068080001,10.7215983480001 46.8001419070001,10.743819213 46.8125184130001,10.7486767980001 46.8194430550001,10.7389616290001 46.829545797,10.6624805090001 46.860965068,10.6470809320001 46.863755596,10.6294075930001 46.862412008,10.5277083740001 46.8432142130001,10.4862638750001 46.8463664750001,10.4538110760001 46.8644273890001,10.4514339600001 46.8857697560001,10.4638363030001 46.9197470090001,10.4584619550001 46.9366193650001,10.4495736080001 46.9439057420001,10.4155705160001 46.9624059050001,10.3946932370001 46.9854019160001,10.3843579500001 46.9929983520001,10.3843579500001 46.9931533820001,10.384254598 46.9931533820001,10.3789836020001 46.9955046590001,10.3734025470001 46.9962539670001,10.3679248460001 46.9955046590001,10.3388826910001 46.9841100060001,10.3136645920001 46.9643179330001,10.2961979570001 46.9413735970001,10.2956811930001 46.9226925660001,10.2707731520001 46.9218915810001,10.2513428140001 46.92537974,10.2351164150001 46.9233126840001,10.2199235430001 46.9057685350001,10.2151693110001 46.8931078090001,10.2143424880001 46.8846845500001,10.211655314 46.8770364380001,10.2014233810001 46.866830343,10.1578084710001 46.8516116340001,10.1319702550001 46.846573182,10.1251875080001 46.8467512290001,10.1112996830001 46.8471157840001,10.068098185 46.8566242480001,10.0455672600001 46.8655642710001,10.0069132890001 46.8907565310001,9.89994307500004 46.9143984990001,9.87513838700011 46.9274209600001,9.86242598400014 46.9397716270001,9.86077233900011 46.9491508990001,9.86397627800008 46.959925436,9.86645674600004 46.9833865360001,9.87059086100007 46.9929466760001,9.87059086100007 46.9988377900001,9.86676680500003 47.001938375,9.86056563300014 47.0016024780001,9.85632816500009 47.0040829470001,9.85798181200005 47.0154776,9.6690527750001 47.0561986290001,9.65230961100005 47.0579297900001,9.59990970900012 47.053485616,9.58120284000003 47.0568704230001,9.60879805500014 47.0807707730001,9.61572269700011 47.106764018,9.60559411600008 47.1322663370001,9.5818229570001 47.1549006150001,9.55205733200012 47.1668895470001,9.5519539790001 47.175571188,9.56187585400008 47.1906090290001,9.56290938300006 47.1977403770001,9.55433109500012 47.2116154990001,9.54482263200015 47.2203229780001,9.54037845800013 47.2291079720001,9.54709639500007 47.2430347700001,9.53024987800009 47.253654277,9.52115482500011 47.2628010050001,9.55329756700007 47.2998530080001,9.58740401200012 47.3278099570001,9.59122806800008 47.3346829230001,9.59639571100007 47.352304586,9.60104659000012 47.3612704470001,9.63980391400005 47.3945242310001,9.6495190840001 47.409717103,9.65034590700012 47.452091777,9.62171716300014 47.4691966760001,9.58451013200005 47.4807205210001,9.55495121200011 47.5108995570001,9.55305859100008 47.5168913380001,9.54748167400007 47.5345471020001,9.54988692200004 47.5335338340001,9.5541438520001 47.5327431110001,9.61262211100006 47.5218807990001,9.6767008870001 47.5226301070001,9.7039860430001 47.5314151000001,9.71845544400011 47.5467113240001,9.73085778800009 47.5649014290001,9.75266524200012 47.5820580040001,9.76713464300005 47.5872773240001,9.78212080900005 47.5884142050001,9.79628015200007 47.5849518850001,9.80795902500006 47.5763219200001,9.81126631700005 47.5644880170001,9.80930261200012 47.5523182170001,9.81312666900007 47.541750387,9.83348718200008 47.5346190390001,9.84154870600008 47.5350324500001,9.85384769700011 47.5404068000001,9.8589119880001 47.541336975,9.88898767100008 47.5337922160001,9.91875329600015 47.5321902470001,9.93384281400006 47.5342056280001,9.94593509900005 47.5407685340001,9.94872562600008 47.5242320770001,9.95916426600013 47.5148786430001,9.97166996200014 47.5064037070001,9.98076501500009 47.4929419970001,9.98076501500009 47.489918925,9.98107507300008 47.4868700160001,9.98262536600009 47.481030579,9.99358077000008 47.4765864060001,10.0023657640001 47.4791702270001,10.0112541100001 47.4844412240001,10.0226229240001 47.4879552210001,10.0718188880001 47.4391209930001,10.0806038810001 47.427390442,10.0759530030001 47.4168742880001,10.0532153730001 47.4048595180001,10.0641707760001 47.3961778780001,10.0668579510001 47.385790914,10.0677881270001 47.375042217,10.0731624750001 47.365482076,10.0828776440001 47.3590741990001,10.0895955810001 47.359280904,10.0972436930001 47.3631307990001,10.1103695070001 47.3673941040001,10.1153304440001 47.3669548550001,10.1256657310001 47.3626915490001,10.1308333740001 47.3626657110001,10.1350708420001 47.3648877970001,10.1469564200001 47.3738019820001,10.1908813880001 47.3792280080001,10.2092781980001 47.3724842330001,10.2085547290001 47.3544749960001,10.1904679770001 47.3174746710001,10.1927417390001 47.3109117640001,10.1932585040001 47.3049172980001,10.1907780360001 47.298251038,10.1859204510001 47.2949954230001,10.1726912840001 47.292308248,10.1686605220001 47.290422058,10.1594621180001 47.2791307580001,10.1554313550001 47.2728779090001,10.1598755290001 47.2711209110001,10.1749508500001 47.2723755540001,10.2393538820001 47.2777354940001,10.2611613360001 47.283497416,10.3059131260001 47.3021784470001,10.325446818 47.3143224090001,10.3434302160001 47.3307555140001,10.3656510820001 47.361115418,10.3716455490001 47.3673941040001,10.3819808350001 47.3721224980001,10.403064819 47.3771092730001,10.4116431070001 47.381036683,10.4282829180001 47.3960486860001,10.4428556720001 47.41628001,10.4519507240001 47.4387592570001,10.4517440180001 47.460204977,10.447609904 47.4725814830001,10.4422355550001 47.4813923140001,10.4336572670001 47.4878518680001,10.4196012780001 47.4930453500001,10.4297298580001 47.532913717,10.430970093 47.542163798,10.4243555090001 47.5533517460001,10.4156738680001 47.5643846650001,10.4142269290001 47.5730146280001,10.4292130940001 47.5770195520001,10.4459562580001 47.5790607710001,10.4536043700001 47.58110199,10.4571183680001 47.5792416380001,10.46156254 47.5699140430001,10.4603223060001 47.5659866330001,10.4554647210001 47.5611807260001,10.4517440180001 47.5548245240001,10.4535010170001 47.546246236,10.4587720130001 47.5416470340001,10.4669368900001 47.5377196250001,10.4825431720001 47.5328620400001,10.5251245520001 47.5284695440001,10.5369067790001 47.5298648080001,10.5496191810001 47.5367894500001,10.5698763430001 47.5559355670001,10.5837256270001 47.5624726360001,10.6079101970001 47.5622659300001,10.7398918050001 47.5284695440001,10.7439225670001 47.525317281,10.7472298580001 47.5201496380001,10.7521907950001 47.5153954060001,10.7607690830001 47.5136384070001,10.7903280030001 47.5160672,10.8306356200001 47.5285728960001,10.8447949620001 47.5313117470001,10.8586442470001 47.530665792,10.869289591 47.5265833540001,10.8922339280001 47.5148786430001,10.8838623460001 47.508005676,10.851616252 47.4930970260001,10.8584375400001 47.485164693,10.9099072670001 47.4689899700001,10.9598267010001 47.432506409,10.9628239340001 47.4279588830001,10.9631339920001 47.4212409470001,10.9608602290001 47.4143163050001,10.9576562910001 47.409717103,10.9552791750001 47.4096137500001,10.9655111080001 47.3960745240001,10.9794637450001 47.3905451460001,11.0837467850001 47.3895116180001,11.1032804770001 47.393568218,11.1685994870001 47.4242640180001,11.1938175870001 47.4289407350001,11.2152116290001 47.422997945,11.213041219 47.3958161420001,11.2370190830001 47.3939557900001,11.2588265380001 47.4007254030001,11.2730892330001 47.4111123660001,11.2863184000001 47.4232046510001,11.3056453850001 47.4354002900001,11.3242489010001 47.439431051,11.3676571050001 47.4401286830001,11.383883504 47.4448570760001,11.3924617920001 47.4547789510001,11.3886377360001 47.462220357,11.3777856850001 47.4670521040001,11.3654866940001 47.469325867,11.4126156 47.506093648,11.4353532310001 47.5097109990001,11.4599512120001 47.5074372360001,11.48258549 47.5025796510001,11.5295076900001 47.5078506480001,11.5512117920001 47.5136900840001,11.569401896 47.527384339,11.5744661860001 47.53663442,11.5823210040001 47.559785462,11.5891422930001 47.5703791310001,11.6170475670001 47.58676056,11.6204582110001 47.58965444,11.6389583740001 47.5892410280001,11.6825732830001 47.583349915,11.7640153400001 47.583117371,11.8203426510001 47.5752883910001,11.8306779380001 47.5776138310001,11.8407031660001 47.5946153770001,11.8519686270001 47.599162903,11.935891154 47.6107384240001,12.1656445720001 47.6039688110001,12.1736027420001 47.605079855,12.2021281330001 47.629832866,12.205745483 47.6362149050001,12.2067790120001 47.6455683390001,12.2051253660001 47.6722850550001,12.2023348390001 47.6777885950001,12.1972705490001 47.6800881960001,12.189105672 47.6855658980001,12.1817676190001 47.6921288050001,12.1785636800001 47.6976581830001,12.1765999760001 47.7058230590001,12.1924129640001 47.7101638800001,12.2164941810001 47.7237031050001,12.225175822 47.7273721320001,12.2397485760001 47.7316871140001,12.2422290440001 47.7320230110001,12.2391284590001 47.7274496460001,12.2365446370001 47.7167784630001,12.233030639 47.7088719690001,12.2266227620001 47.7028775020001,12.22331547 47.6959011840001,12.2287931720001 47.6848682660001,12.2387150470001 47.6788996390001,12.2495670980001 47.6800106820001,12.271891317 47.687891337,12.293698771 47.6900100710001,12.351473023 47.681690166,12.368422892 47.683550517,12.4076969800001 47.6937307740001,12.4241300860001 47.691560365,12.428780965 47.685798442,12.4392196040001 47.664481914,12.4446973060001 47.656291199,12.4527588300001 47.64975413,12.482524454 47.6335794070001,12.4965804440001 47.6289026900001,12.517147664 47.6285409550001,12.5382316490001 47.6313314820001,12.5538379310001 47.6360081990001,12.5633749190001 47.6417613700001,12.5983830150001 47.662879944,12.6173999430001 47.6693394980001,12.6530566810001 47.6751272590001,12.6887134190001 47.6751272590001,12.744834025 47.6653604130001,12.7619906000001 47.6668590290001,12.7516553140001 47.6493923960001,12.7673649500001 47.6363699350001,12.7933065180001 47.6247944130001,12.8131502690001 47.611823629,12.7858651120001 47.6026769010001,12.7736694740001 47.5795000210001,12.7789404700001 47.5548245240001,12.8036418050001 47.541336975,12.8190413810001 47.5395283000001,12.8284464920001 47.5372545380001,12.8369214270001 47.532655335,12.8826033930001 47.4985747280001,12.9315926510001 47.4735116580001,12.9425480550001 47.4704885870001,12.9510229900001 47.4724781300001,12.9592912190001 47.475527039,12.969729858 47.4757337450001,12.9793416740001 47.472245586,12.9849227290001 47.4682665000001,12.991123901 47.4656826790001,13.0018725990001 47.466018576,13.0087972410001 47.4701010140001,13.0373226310001 47.4930453500001,13.0370125730001 47.5013652550001,13.0344287510001 47.5074372360001,13.0312248120001 47.5125532030001,13.0289510500001 47.5180309050001,13.0281242270001 47.5242320770001,13.0281242270001 47.5416470340001,13.0306046960001 47.5442566940001,13.040113159 47.5604572550001,13.0412500410001 47.5619041960001,13.0390796310001 47.5613357550001,13.038252807 47.5840217090001,13.0409399820001 47.583349915,13.0570630290001 47.5976642860001,13.057683146 47.600428976,13.0695687250001 47.620246887,13.072049194 47.6224172980001,13.0742196040001 47.6345095830001,13.0748397220001 47.646653545,13.072049194 47.6594692990001,13.0640910240001 47.6739903770001,13.0445573320001 47.6965729780001,13.0322583410001 47.7066240440001,13.0198559980001 47.712928569,13.004353068 47.7146080530001,12.979031616 47.7070891320001,12.9640454510001 47.7053579710001,12.9083382560002 47.7123601290001,12.8920085040001 47.723548076,12.9106120190001 47.7429267380001,12.9108187260001 47.7430300900001,12.9108187260001 47.743081767,12.9172266030001 47.7501614380001,12.9189836020001 47.7567760220001,12.919293661 47.7631838990001,12.9212573650001 47.7695401010001,12.926735067 47.7773949180001,12.9912272540001 47.8471064260001,12.9865763750001 47.8502586880001,12.9649756260001 47.87196279,12.9310758870001 47.924879456,12.91422937 47.935989889,12.9061678470001 47.9389096070001,12.8860140380001 47.9528880820001,12.8620361730001 47.962551575,12.8539746500001 47.9704839070001,12.8486003010001 47.9809483850001,12.8482462710001 47.98238892,12.8456030680001 47.9931440230001,12.8306169030001 48.015468242,12.7602336020001 48.064870911,12.7509318440001 48.07474111,12.7420434980001 48.0867817180001,12.7369792070001 48.0999592090001,12.7389429120001 48.113446757,12.7450407310001 48.1206297820001,12.7514486080001 48.1221025600001,12.7579598390001 48.1218958540001,12.7640576580001 48.1237562050001,12.7783203530001 48.138716533,12.782351115 48.1420238250001,12.822141968 48.1606790170001,12.8351644290001 48.170704244,12.853457886 48.1899795530001,12.8625529380001 48.1966458130001,12.8776424560001 48.202046001,12.9330395910001 48.2092548630001,12.9316960040001 48.2116319790001,12.9471989340001 48.2200035610001,12.9794450270001 48.2320183320001,13.0166520590001 48.2558928430001,13.0327751060001 48.2635667930001,13.1364380290001 48.2910586550001,13.2742073970001 48.3071041870001,13.3077970790001 48.3196357220001,13.4055688880001 48.376583151,13.4195215250001 48.3921635950001,13.4252059320001 48.41337677,13.4271696370001 48.418544413,13.4317171630001 48.423712057,13.4361613360001 48.4305850220001,13.4382283940001 48.4409978240001,13.4363680420001 48.4692389940001,13.4382283940001 48.478540752,13.4429826250001 48.4877133190001,13.4564184980001 48.5066527310001,13.4592090250001 48.516393738,13.457038615 48.5251787320001,13.4477368570001 48.534816386,13.4437060950001 48.552851461,13.4407088620001 48.5573473110001,13.4400887450001 48.560964661,13.4455664470001 48.5679151410001,13.4545581460001 48.5734445190001,13.4872176520001 48.581583557,13.5207039790001 48.5845807910001,13.6243669020001 48.565357158,13.6418335370001 48.5591043090001,13.6580599360001 48.5510944630001,13.6733561600001 48.5354881800001,13.714335571 48.5232150270001,13.7165059810001 48.5216905720001,13.7253943280001 48.5483814500001,13.7338692630001 48.559776103,13.7372799070001 48.5592593390001,13.7580538330001 48.5614814250001,13.7660120030001 48.5637551880001,13.7742802330001 48.5692070520001,13.7790344640001 48.5739354460001,13.7961910400001 48.5985851040001,13.8023922110001 48.6117109180001,13.8054927980001 48.6261286420001,13.8062162680001 48.6429234830001,13.8009452720001 48.6752212530001,13.8035290930001 48.687158508,13.8168616120001 48.6955817670001,13.8043559160001 48.6995608520001,13.7993949790001 48.7026097620001,13.7887496340001 48.7165107230001,13.7835819910001 48.7152704880001,13.7858557540001 48.724778951,13.8157247310001 48.7664301560001,13.8559289960001 48.759298808,13.8749459230001 48.7524258430001,13.8931360270001 48.7430207320001,13.9150468340001 48.730980124,13.9823295490001 48.7064854940001,13.991114543 48.7001809700001,14.0077543540001 48.6832827760001,14.0141622310001 48.675066223,14.0192265210001 48.6719139610001,14.0261511640001 48.6700536100001,14.0321456300001 48.667263082,14.0347294510001 48.6611652630001,14.0328691000001 48.6549124140001,14.028321574 48.6539822390001,14.023463989 48.6546023560001,14.0204667560001 48.6531554160001,14.0137488200001 48.643801982,14.008064412 48.6424067180001,14.0062040600001 48.6395128380001,14.0108549390001 48.6258702600001,14.0151957600001 48.6203925580001,14.0324556880001 48.606129863,14.0408272700001 48.6011689250001,14.0748303630001 48.5917121390001,14.2165271400001 48.581170146,14.3157458900001 48.557915752,14.3253577060001 48.5586392210001,14.3332125250001 48.5607062790001,14.3533663330001 48.5714291390001,14.4053528230001 48.5862861130001,14.4211658120001 48.597060649,14.4435933840001 48.6365156050001,14.4581661370001 48.6431818650001,14.4821440020001 48.6244749970001,14.5220382080001 48.610625712,14.5338204340001 48.6087136840001,14.5488065990001 48.6109357710001,14.5787789300001 48.620495911,14.5941785070001 48.621322734,14.600586385 48.617576193,14.6018266190001 48.6111941530001,14.6019299730001 48.6045278930001,14.6051339110001 48.6003162640001,14.6128853760001 48.5997478230001,14.6281816 48.603287659,14.6346928310001 48.6023316450001,14.645441529 48.5929006960001,14.6513326410001 48.5834955850001,14.6591874590001 48.5769585170001,14.6756205650001 48.5762350460001,14.691140439 48.5865349630001,14.6956710200001 48.5895417280001,14.7007353100001 48.6155349740001,14.7002185460001 48.6461015830001,14.7038358970001 48.6731025190001,14.722749471 48.693411357,14.7753560790001 48.7240038050001,14.7804203700001 48.743124085,14.7904455970001 48.7548546350001,14.794476359 48.766998597,14.8003674720001 48.7765070600001,14.8154569910001 48.780331116,14.8676501870001 48.7755768840001,14.91932662 48.761572571,14.939583781 48.7628128060001,14.9510559490001 48.780331116,14.9488855380001 48.7821397910001,14.9444413660001 48.7885993450001,14.9401005450001 48.7965058390001,14.9381368400001 48.8028103640001,14.9397904870001 48.809786682,14.9470251870001 48.8223957320001,14.9682125240001 48.8850275680001,14.9683158770001 48.9126744590001,14.964181763 48.9432669070001,14.964595174 48.9717406220001,14.9782377530001 48.9928246050001,14.9773075770001 48.998250631,14.9773075770001 49.0029015100001,14.9788578690001 49.006260478,14.9820618080001 49.0079141240001,15.0039726160001 49.0097744750001,15.059576457 48.9972171020001,15.1374011640001 48.993031311,15.1447392170001 48.9789236450001,15.148976684 48.965332743,15.148563273 48.951741842,15.1419486890001 48.937479147,15.1617924400001 48.9372207640001)))");

        austria = CountriesEntity.builder()
                .geom(geometry)
                .name("Austria").code("AUT").sovereignt("Austria").sovA3("AUT").admin("Austria")
                .popEst(8210281.0).gdpMdEst(329500.0)
                .incomeGrp("1. High income: OECD")
                .continent("Europe").regionUn("Europe").subregion("Western Europe")
                .regionWb("Europe & Central Asia")
                .build();

        EntityTransaction t = em.getTransaction();
        t.begin();
        em.persist(austria);
        em.flush();
        t.commit();

    }

    @Test
    @SneakyThrows
    @Parameters(method = "coordinateValues")
    public void shouldReturnAustria(Coordinate coordinate){

        AreaLocationTypesEntity areaLocationTypesEntity = new AreaLocationTypesEntity();
        areaLocationTypesEntity.setTypeName("COUNTRY");
        String nativeQueryByType = getNativeQueryByType(areaLocationTypesEntity.getTypeName());

        List list = areaDao.findAreaOrLocationByCoordinates(geometryFactory.createPoint(coordinate), nativeQueryByType);

        assertEquals(austria, list.get(0));

    }

    protected Object[] coordinateValues(){

        return $(
                $(new Coordinate(16.569613472222223, 48.11034788888889),
                  new Coordinate(16.659393, 48.074179),
                  new Coordinate(14.501953, 46.468133)
                )
        );
    }

}
