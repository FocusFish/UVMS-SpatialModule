sql.findAreasIdByLocation = SELECT CAST(gid AS text) AS id, name, code FROM spatial.{tableName} where st_intersects(geom, st_geomfromtext(CAST(:wktPoint as text), :crs)) and enabled = 'Y'
sql.findClosestArea = WITH prox_query AS (SELECT CAST(gid AS text), code, name, st_closestpoint(geom, st_geomfromtext(CAST(:wktPoint as text), :crs)) as closestPoint FROM spatial.{tableName} where enabled = 'Y' ORDER BY geom <#> st_geomfromtext(CAST(:wktPoint as text), :crs) limit 30) SELECT gid AS id, code, name, st_length_spheroid(st_makeline(closestPoint, st_geomfromtext(CAST(:wktPoint as text), :crs)), 'SPHEROID["WGS 84",6378137,298.257223563]') /:unit AS distance FROM prox_query ORDER BY distance LIMIT 1
sql.findClosestLocation = SELECT CAST(gid AS text) AS id, code, name, ST_Distance_Spheroid(geom, st_geomfromtext(CAST(:wktPoint as text), :crs), 'SPHEROID["WGS 84",6378137,298.257223563]') /:unit AS distance FROM spatial.{tableName} where not ST_IsEmpty(geom) order by distance limit 1
sql.searchArea = SELECT gid, name, code, CAST(st_astext(st_extent(geom)) AS text) as extent FROM spatial.{tableName} WHERE name ILIKE '%{name}%' or code ILIKE '%{code}%' GROUP BY gid
sql.areasByGidList = SELECT gid, name, code, CAST(st_astext(st_extent(geom)) AS text) as extent FROM spatial.{tableName} WHERE gid in ({gids}) GROUP BY gid
sql.filterAreas = SELECT wkt_geometry as wktGeometry, result_code as resultCode FROM spatial.filter_geom(:userAreaTypes, :userAreaIds, :scopeAreaTypes, :scopeAreaIds)